<!DOCTYPE html>
<html lang='{{ .Param "language-code" | default site.LanguageCode }}'>
<head
  itemscope itemtype="http://schema.org/WebSite"
>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
      {{ .Title }}
  </title>

  {{ partial "header/meta.html" . }}
  {{ partial "header/google-analytics-async.html" . }}

  {{ $cssFonts := resources.Get "css/fonts.css" }}
  {{ $cssTW := resources.Get "css/main.css" }}
  {{ $css := slice $cssFonts $cssTW | resources.Concat "styles.css" }}
  {{ $css = $css | postCSS }}
  {{ if ne hugo.Environment "development" }}
    {{ $css = $css | minify | fingerprint | resources.PostProcess }}
    <style type="text/css">
      {{ $css.Content }}
    </style>
  {{ else }}
    <link rel="stylesheet" href="{{ $css.RelPermalink }}">
  {{ end }}
  {{ $minify := not site.IsServer }}
  {{ $jsOpts := dict
    "minify" $minify
    "targetPath" "/@src/enhancements.js"
    "target" "es2019"
    "defines" (dict
      "process.env.NODE_ENV" `"production"`
      "ALPINE_VERSION" `"spl-dev"`
    )
    "params" (dict
      "apiBaseURL" (.Param "api-base-url")
  )}}
  {{ $js := resources.Get "js/main.js" | js.Build $jsOpts }}
  {{ if $minify }}
    {{ $js = $js | minify }}
    <script type="module">
      {{ $js.Content | safeJS }}
    </script>
  {{ else }}
    <script type="module" src="{{ $js.RelPermalink }}"></script>
  {{ end }}
  {{ $jsOpts = dict "minify" $minify "targetPath" "embed.js" "target" "es2019" }}
  {{ $js = resources.Get "js/embed.js" | js.Build $jsOpts }}
  <meta name="embed-script" src="{{ $js.RelPermalink }}">
  <noscript>
    <style>
      .no-js-only {
        display: block;
      }
      .no-js-hide {
         display: none;
      }
    </style>
  </noscript>
</head>
{{ $pageCat := printf "%s:%s" (.Section | default .Type) .Kind }}
{{ if eq .Kind "home" }}{{ $pageCat = "home "}}{{ end }}
<body
  data-ga-label='interactive:redistricting-2020'
  data-ga-category="interactive"
  class="w-screen overflow-hidden flex flex-col bg-beige font-rale text-g-9 leading-normal"
>
  <main
    class="bg-white flex-grow p-1"
    x-data="app">
    <h1 class="text-black font-bold text-xl">
      <svg
        class="inline-block h-10 w-10 fill-current text-black"
        role="img"
        aria-label="Spotlight PA logo"
      >
        <use xlink:href="#logo-svg"></use>
      </svg>
      <span>
        Redistricting
      </span>
    </h1>
    <p class="text-sm">
      Pennsylvania has new political maps. See which districts your home is in.
    </p>

    <form class="mt-4 flex gap-1 items-stretch" @submit.prevent>
      <button
        class="
          px-4 flex-shrink-0
          rounded-l-lg border-2 border-goldenrod
          bg-yellow
        "
        type="button"
        @click="byLocation"
      >
        <svg
          class="inline-block h-6 w-6 fill-current text-white"
          role="img"
          aria-label="Spotlight PA logo"
        >
          <use xlink:href="#crosshairs-svg"></use>
        </svg>
      </button>
      <input
        class="
          px-4 py-2
          block w-full appearance-none
          border-2 border-g-4 hover:border-g-5
          bg-white text-g-8
          placeholder-g-5 placeholder-opacity-100
          tracking-wider
        "
        placeholder="1723 Commonwealth Ave, Harrisburg"
        x-model="address"
        autofocus
      >
      <button
        class="
          px-4
          rounded-r-lg border-2 border-goldenrod
          bg-yellow text-g-1
          font-bold tracking-widest uppercase
        "
        @click="byAddress()"
      >
        <svg
          class="w-6 h-6 fill-current text-white"
          :class="{ 'animate-bounce': isLoadingThrottled }"
        >
          <use xlink:href="#search-svg"></use>
        </svg>
      </button>
    </form>


    <template x-if="error">
      <div class="text-orange font-semibold" x-text="error"></div>
    </template>
    <div x-text="`
      lat ${lat}, long ${long}
      old house ${oldHouse} new house ${newHouse}
      old senate ${oldSenate} new senate ${newSenate}
    `"></div>

    <footer>
      <p class="mt-2 text-right">
        <svg
          class="inline-block h-8 w-48 fill-current text-g-8"
          role="img"
          aria-label="Spotlight PA banner"
        >
          <use xlink:href="#banner-svg"></use>
        </svg>
      </p>
    </footer>
    <datalist>
      {{ range site.Data.report }}
        <option
          x-ref="contact-{{ .County }}"
          data-mailto="mailto:{{.warden}}<{{.email}}>"
          data-phone="tel:{{.phone}}"
        >
      {{ end }}
    </datalist>
  </main>

  {{ $svgs := dict
    "banner-svg" "/img/logos/banner-default-on-trans.svg"
    "logo-svg" "/img/logos/circle-default-on-trans.svg"
    "crosshairs-svg" "@fontawesome/solid/crosshairs.svg"
    "search-svg" "@fontawesome/solid/search.svg"
  }}
  <div hidden>
    {{ range $id, $rsc := $svgs }}
      {{ $svg := resources.Get $rsc }}
      <svg id="{{ $id }}">{{ $svg.Content|safeHTML }}</svg>
    {{ end }}
  </div>
</body>
</html>
